<!DOCTYPE html>
<html lang="en" dir="auto" data-theme="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Get the env vars your app started with | Tales Of Details</title>
<meta name="keywords" content="">
<meta name="description" content="The setup should be familiar. You have an app that is ready to ship, so you put it in a docker image.
Any config after that is done mostly via env vars.
For anything non-trivial like e.g - mounting and parsing secrets to env vars - making sure certain default values are overriden
you need an init script that calculates the var&rsquo;s desired value, then exports it like
export MY_CONFIG_VAR=calculated_value
And once done, you&rsquo;d start the app with your equivalent of">
<meta name="author" content="
stelis">
<link rel="canonical" href="https://details.systematize.it/details/2024-09-14-get-the-env-vars-your-app-started-with/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.da3211e5ef867bf2b75fd5a6515cfed7195c011e8ab735694e203810a827097b.css" integrity="sha256-2jIR5e&#43;Ge/K3X9WmUVz&#43;1xlcAR6KtzVpTiA4EKgnCXs=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://details.systematize.it/assets/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://details.systematize.it/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://details.systematize.it/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://details.systematize.it/apple-touch-icon.png">
<link rel="mask-icon" href="https://details.systematize.it/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://details.systematize.it/details/2024-09-14-get-the-env-vars-your-app-started-with/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
                color-scheme: dark;
            }

            .list {
                background: var(--theme);
            }

            .toc {
                background: var(--entry);
            }
        }

        @media (prefers-color-scheme: light) {
            .list::-webkit-scrollbar-thumb {
                border-color: var(--code-bg);
            }
        }

    </style>
</noscript>
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.querySelector("html").dataset.theme = 'dark';
    } else if (localStorage.getItem("pref-theme") === "light") {
       document.querySelector("html").dataset.theme = 'light';
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.querySelector("html").dataset.theme = 'dark';
    } else {
        document.querySelector("html").dataset.theme = 'light';
    }

</script><meta property="og:url" content="https://details.systematize.it/details/2024-09-14-get-the-env-vars-your-app-started-with/">
  <meta property="og:site_name" content="Tales Of Details">
  <meta property="og:title" content="Get the env vars your app started with">
  <meta property="og:description" content="The setup should be familiar. You have an app that is ready to ship, so you put it in a docker image.
Any config after that is done mostly via env vars.
For anything non-trivial like e.g - mounting and parsing secrets to env vars - making sure certain default values are overriden
you need an init script that calculates the var’s desired value, then exports it like
export MY_CONFIG_VAR=calculated_value And once done, you’d start the app with your equivalent of">
  <meta property="og:locale" content="en-us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="details">
    <meta property="article:published_time" content="2024-09-14T00:00:00+00:00">
    <meta property="article:modified_time" content="2024-09-14T00:00:00+00:00">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Get the env vars your app started with">
<meta name="twitter:description" content="The setup should be familiar. You have an app that is ready to ship, so you put it in a docker image.
Any config after that is done mostly via env vars.
For anything non-trivial like e.g - mounting and parsing secrets to env vars - making sure certain default values are overriden
you need an init script that calculates the var&rsquo;s desired value, then exports it like
export MY_CONFIG_VAR=calculated_value
And once done, you&rsquo;d start the app with your equivalent of">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Details",
      "item": "https://details.systematize.it/details/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Get the env vars your app started with",
      "item": "https://details.systematize.it/details/2024-09-14-get-the-env-vars-your-app-started-with/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Get the env vars your app started with",
  "name": "Get the env vars your app started with",
  "description": "The setup should be familiar. You have an app that is ready to ship, so you put it in a docker image.\nAny config after that is done mostly via env vars.\nFor anything non-trivial like e.g - mounting and parsing secrets to env vars - making sure certain default values are overriden\nyou need an init script that calculates the var\u0026rsquo;s desired value, then exports it like\nexport MY_CONFIG_VAR=calculated_value And once done, you\u0026rsquo;d start the app with your equivalent of\n",
  "keywords": [
    
  ],
  "articleBody": "The setup should be familiar. You have an app that is ready to ship, so you put it in a docker image.\nAny config after that is done mostly via env vars.\nFor anything non-trivial like e.g - mounting and parsing secrets to env vars - making sure certain default values are overriden\nyou need an init script that calculates the var’s desired value, then exports it like\nexport MY_CONFIG_VAR=calculated_value And once done, you’d start the app with your equivalent of\nexec java -jar myapp.jar ... At some point after that, you need to know what the value to some of those variables was. So you exec inside the container and do a\nprintenv but you can’t find any of the vars you exported.\nInconveniently, that is to be expected.\nThe vars were exported for the shell that was running at startup time and that died once it handed over the PID to your app, not the shell that spawned when you run\ndocker exec So? Is the info you need lost? Fortunately not.\nThe processes store their initial environment in /proc/${PID}/environ.\nSo all you need is something like\ncat /proc/1/environ | tr '\\0' '\\n' | sort Need the current instead of the initial environment? That should be quite a bit trickier as a Google search will reveal.\nGood thing is, though, that processes altering their env vars is not (at least in my experience) a usual scenario.\nIt’s definitely not one I’d like to be in, if given the choice.\nWhy use exec ? As in exec java -jar myapp.jar instead of just java -jar myapp.jar.\nWell, Docker is all about the process with PID 1.\nIt’s the one whose logs are shown in docker logs -f and the one that if killed, the container does too along with it. It’s also the one to receive and handle the signals, e.g SIGTERM from a docker stop. Since we’ve used an init script to prepare the ground for our app, then it’s the shell that has gotten PID 1.\nexec hands over the PID so now it’s the app that has PID 1 and everything works as expected.\n",
  "wordCount" : "358",
  "inLanguage": "en",
  "datePublished": "2024-09-14T00:00:00Z",
  "dateModified": "2024-09-14T00:00:00Z",
  "author":{
    "@type": "Person",
    "name": {"email":"stelis@systematize.it","name":"stelis"}
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://details.systematize.it/details/2024-09-14-get-the-env-vars-your-app-started-with/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Tales Of Details",
    "logo": {
      "@type": "ImageObject",
      "url": "https://details.systematize.it/assets/favicon.ico"
    }
  }
}
</script>
</head>
<body id="top">
    <header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://details.systematize.it/" accesskey="h" title="Tales Of Details (Alt + H)">Tales Of Details</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://details.systematize.it/">Home</a>&nbsp;»&nbsp;<a href="https://details.systematize.it/details/">Details</a></div>
    <h1 class="post-title entry-hint-parent">
      Get the env vars your app started with
    </h1>
    <div class="post-meta"><span title='2024-09-14 00:00:00 +0000 UTC'>September 14, 2024</span>&nbsp;·&nbsp;<span>
<a href="mailto:stelis@systematize.it">stelis</a></span>

</div>
  </header> 
  <div class="post-content"><p>The setup should be familiar. You have an app that is ready to ship, so you put it in a docker image.<br>
Any config after that is done mostly via env vars.</p>
<p>For anything non-trivial like e.g - mounting and parsing secrets to env vars - making sure certain default values are overriden</p>
<p>you need an init script that calculates the var&rsquo;s desired value, then exports it like</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>export MY_CONFIG_VAR<span style="color:#f92672">=</span>calculated_value
</span></span></code></pre></div><p>And once done, you&rsquo;d start the app with your equivalent of</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>exec java -jar myapp.jar ...
</span></span></code></pre></div><p>At some point after that, you need to know what the value to some of those variables was. So you exec inside the container and do a</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>printenv
</span></span></code></pre></div><p>but you can&rsquo;t find any of the vars you exported.<br>
Inconveniently, <em>that is to be expected</em>.<br>
The vars were exported for the shell that was running at startup time and that died once it handed over the PID to your app, not the shell that spawned when you run</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>docker exec
</span></span></code></pre></div><p>So? Is the info you need lost? Fortunately not.<br>
The processes store their <em>initial</em> environment in <code>/proc/${PID}/environ</code>.<br>
So all you need is something like</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>cat /proc/1/environ | tr <span style="color:#e6db74">&#39;\0&#39;</span> <span style="color:#e6db74">&#39;\n&#39;</span> | sort
</span></span></code></pre></div><h2 id="need-the-current-instead-of-the-initial-environment">Need the <em>current</em> instead of the <em>initial</em> environment?<a hidden class="anchor" aria-hidden="true" href="#need-the-current-instead-of-the-initial-environment">#</a></h2>
<p>That should be quite a bit trickier as a Google search will reveal.<br>
Good thing is, though, that processes altering their env vars is not (at least in my experience) a usual scenario.<br>
It&rsquo;s definitely not one I&rsquo;d like to be in, if given the choice.</p>
<h2 id="why-use-exec-">Why use <em>exec</em> ?<a hidden class="anchor" aria-hidden="true" href="#why-use-exec-">#</a></h2>
<p>As in <code>exec java -jar myapp.jar</code> instead of just <code>java -jar myapp.jar</code>.<br>
Well, Docker is all about the process with PID 1.</p>
<ul>
<li>It&rsquo;s the one whose logs are shown in <code>docker logs -f</code> and the one that if killed, the container does too along with it.</li>
<li>It&rsquo;s also the one to receive and handle the signals, e.g SIGTERM from a <code>docker stop</code>.</li>
</ul>
<p>Since we&rsquo;ve used an init script to prepare the ground for our app, then it&rsquo;s the shell that has gotten PID 1.<br>
<code>exec</code> hands over the PID so now it&rsquo;s the app that has PID 1 and everything works as expected.</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
    </ul>
<nav class="paginav">
  <a class="prev" href="https://details.systematize.it/details/2024-09-14-can-i-get-free-email-for-my-custom-domain-please/">
    <span class="title">« Prev</span>
    <br>
    <span>Can I get Free Email for my custom Domain, please?</span>
  </a>
  <a class="next" href="https://details.systematize.it/details/2024-09-10-meet-your-heroes/">
    <span class="title">Next »</span>
    <br>
    <span>Meet your Heroes!</span>
  </a>
</nav>

  </footer><script src="https://utteranc.es/client.js"
        repo="stelispanagiotakis/details"
        issue-term="pathname"
        theme="preferred-color-scheme"
        crossorigin="anonymous"
        async>
</script>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2026 <a href="https://details.systematize.it/">Tales Of Details</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu');
    if (menu) {
        
        const scrollPosition = localStorage.getItem("menu-scroll-position");
        if (scrollPosition) {
            menu.scrollLeft = parseInt(scrollPosition, 10);
        }
        
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        const html = document.querySelector("html");
        if (html.dataset.theme === "dark") {
            html.dataset.theme = 'light';
            localStorage.setItem("pref-theme", 'light');
        } else {
            html.dataset.theme = 'dark';
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
